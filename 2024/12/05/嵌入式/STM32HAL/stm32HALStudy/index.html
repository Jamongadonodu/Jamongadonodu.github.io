<!DOCTYPE html><html lang="zh-cn" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>stm32HAL库学习笔记合集 | Cherno-Sagiri</title><link rel="icon" type="image/x-icon" href="/icons/favicon.ico"><link rel="preload" as="font" crossorigin="anonymous" href="/font/Bender.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/font/BenderLight.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="/font/JetBrainsMono-Regular.woff2"><link rel="stylesheet" href="/css/arknights.css"><style>@font-face {
  font-family: Bender;
  src: local('Bender'), url("/font/Bender.ttf"), url("/font/Bender.otf");
}
@font-face {
  font-family: BenderLight;
  src: local('BenderLight'), url("/font/BenderLight.ttf");
}
@font-face {
  font-family: 'JetBrains Mono';
  src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
</style><script>var config = {"root":"/","code_fold":15,"search":{"preload":false,"activeHolder":"键入以继续","blurHolder":"数据检索","noResult":"无 $0 相关数据"},"code":{"codeInfo":"$0 - $1 行","copy":"复制"}}</script><link type="text/css" rel="stylesheet" href="/lib/encrypt/hbe.style.css"><script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js"></script><script>MathJax.Hub.Config({
 menuSettings: {
   zoom: "None"
 },
 showMathMenu: false,
 jax: ["input/TeX","output/CommonHTML"],
 extensions: ["tex2jax.js"],
 TeX: {
   extensions: ["AMSmath.js","AMSsymbols.js"],
   equationNumbers: {
     autoNumber: "AMS"
   }
 },
 tex2jax: {
   inlineMath: [["\\(", "\\)"]],
   displayMath: [["\\[", "\\]"]]
 }
});</script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><script>if (window.localStorage.getItem('theme-mode') === 'light')
 document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark')
 document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.woff2") format('woff2');
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><style>:root {
 --dark-background: url('/img/background_dark.png');
 --light-background: url('/img/background_light.jpg');
 --theme-encrypt-confirm: '确认'
}</style><script defer src="/js/arknights.js"></script><script defer src="/js/search.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js"></script><script>MathJax.Hub.Config({
  menuSettings: {
    zoom: "None"
  },
  showMathMenu: false,
  jax: ["input/TeX","output/CommonHTML"],
  extensions: ["tex2jax.js"],
  TeX: {
    extensions: ["AMSmath.js","AMSsymbols.js"],
    equationNumbers: {
      autoNumber: "AMS"
    }
  },
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]]
  }
});
</script><script async src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script async src="/lib/encrypt/hbe.js"></script><script async src="/js/pjax.js"></script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js','data-pjax','.busuanzi'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><script class="pjax-js">reset= () => {MathJax.Hub.Queue(["Typeset", MathJax.Hub]);document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><meta name="generator" content="Hexo 7.3.0"></head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><nav><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup" tabindex="0"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/project/"><span class="navItemTitle">Project</span></a></li><li class="navItem"><a class="navBlock" href="/members/"><span class="navItemTitle">Members</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>stm32HAL库学习笔记合集</h1><div id="post-info"><span>文章发布时间: <div class="control"><time datetime="2024-12-04T16:00:00.000Z" id="date"> 2024-12-05</time></div></span><br><span>最后更新时间: <div class="control"><time datetime="2025-10-25T17:08:07.006Z" id="updated"> 2025-10-26</time></div></span></div></div><hr><div id="post-content"><p>STM32 HAL库基础知识学习笔记，参考了b站大佬的HAL库教程，感谢铁头山羊和keysking<br><span id="more"></span></p>
<h2 id="以stm32f103c8t6为例，基于"><a href="#以stm32f103c8t6为例，基于" class="headerlink" title="以stm32f103c8t6为例，基于"></a>以stm32f103c8t6为例，基于</h2><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV16J4m1w7HB/?spm_id_from=333.1387.collection.video_card.click&amp;vd_source=7b9700545489c9be13182b1c6fa4696e">铁头山羊stm32 HAL库入门教程</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV12v4y1y7uV/?spm_id_from=333.1387.favlist.content.click&amp;vd_source=7b9700545489c9be13182b1c6fa4696e">keysking的STM32教程</a></p>
<h1 id="GPIO篇"><a href="#GPIO篇" class="headerlink" title="GPIO篇"></a>GPIO篇</h1><h2 id="认识引脚"><a href="#认识引脚" class="headerlink" title="认识引脚"></a>认识引脚</h2><p class='item-img' data-src='https://tc-cdn.flowus.cn/oss/efcc5782-4c91-4d25-a0ce-485c5a97482f/1.png?time=1761410700&token=2a96709da6b247ad5b2e66811a8fc958f482298e3a87c387d88f276585a0a52e&role=free'><img src=https://tc-cdn.flowus.cn/oss/efcc5782-4c91-4d25-a0ce-485c5a97482f/1.png?time=1761410700&token=2a96709da6b247ad5b2e66811a8fc958f482298e3a87c387d88f276585a0a52e&role=free></p>
<h2 id="IO复用与重映射"><a href="#IO复用与重映射" class="headerlink" title="IO复用与重映射"></a>IO复用与重映射</h2><p><strong>IO复用</strong> ： 同一个IO引脚具备多个不同的功能<br><strong>复用功能重映射</strong> ： 将冲突的复用功能移动到备用引脚上</p>
<h2 id="GPIO"><a href="#GPIO" class="headerlink" title="GPIO"></a>GPIO</h2><p><strong>GPIO</strong> : General Purpose Input/Output,通用目的的输入/输出</p>
<h3 id="GPIO的8种工作模式"><a href="#GPIO的8种工作模式" class="headerlink" title="GPIO的8种工作模式"></a>GPIO的8种工作模式</h3><p class='item-img' data-src='https://tc-cdn.flowus.cn/oss/26191b32-3ed9-424b-8164-0399c7cd0392/2.png?time=1761411600&token=3ac6189b29f053b5219a9f5aff90394754bb7ec5fdd57fbd4e0107b39440a2a5&role=free'><img src="https://tc-cdn.flowus.cn/oss/26191b32-3ed9-424b-8164-0399c7cd0392/2.png?time=1761411600&token=3ac6189b29f053b5219a9f5aff90394754bb7ec5fdd57fbd4e0107b39440a2a5&role=free"></p>
<h3 id="GPIO的输出模式"><a href="#GPIO的输出模式" class="headerlink" title="GPIO的输出模式"></a>GPIO的输出模式</h3><p class='item-img' data-src='https://tc-cdn.flowus.cn/oss/698f153a-eae8-4b11-9799-010f1cbba3e8/3.png?time=1761411600&token=6ddbc9287aa3c214f4ee9fa39f3df497beae84e14f37527e0e60e035a6fcf5dc&role=free'><img src="https://tc-cdn.flowus.cn/oss/698f153a-eae8-4b11-9799-010f1cbba3e8/3.png?time=1761411600&token=6ddbc9287aa3c214f4ee9fa39f3df497beae84e14f37527e0e60e035a6fcf5dc&role=free"></p>
<p><strong>推挽</strong> ：一对MOS管交替导通，对外输出低电压或高电压<br><strong>开漏</strong> ：PMOS保持关闭，对外输出低电压或高阻态</p>
<p><strong>通用</strong> ：直接控制引脚高低电平<br><strong>复用</strong> ：其他模块托管（如UART等）</p>
<h5 id="GPIO的输出速度"><a href="#GPIO的输出速度" class="headerlink" title="GPIO的输出速度"></a>GPIO的输出速度</h5><p><em>低速</em> ：2MHz<br><em>中速</em> ：10～25MHz<br><em>高速</em> ：50～100MHz</p>
<p>以stm32f103c8t6为例：<br class='item-img' data-src='https://tc-cdn.flowus.cn/oss/5d933210-f155-46ee-8f01-133b445d07ac/4.png?time=1761411600&token=b3ed96b38776051c6e6a585739158aacd4be391b93afa967dc84506e64cd8c8d&role=free'><img src="https://tc-cdn.flowus.cn/oss/5d933210-f155-46ee-8f01-133b445d07ac/4.png?time=1761411600&token=b3ed96b38776051c6e6a585739158aacd4be391b93afa967dc84506e64cd8c8d&role=free"></p>
<h3 id="GPIO的输入模式"><a href="#GPIO的输入模式" class="headerlink" title="GPIO的输入模式"></a>GPIO的输入模式</h3><p><strong>引脚浮空</strong> ：会接受空间电磁波，随机读取0或1<br><strong>上拉电阻</strong> ：当引脚浮空时，提供默认的高电压<br><strong>下拉电阻</strong> ：当引脚浮空时，提供默认的低电压<br><strong>模拟输入</strong> ：接受模拟信号，应用于ADC</p>
<h1 id="UART篇"><a href="#UART篇" class="headerlink" title="UART篇"></a>UART篇</h1><h2 id="UART基础知识"><a href="#UART基础知识" class="headerlink" title="UART基础知识"></a>UART基础知识</h2><h3 id="Tx与Rx"><a href="#Tx与Rx" class="headerlink" title="Tx与Rx"></a>Tx与Rx</h3><p class='item-img' data-src='https://tc-cdn.flowus.cn/oss/5344097e-2e10-4340-9f75-d07002258fff/5.png?time=1761411600&token=bcaa3d3d52d4f49949ba1e412621d6414bdfecb1bcd2f206fea4c124241feb33&role=free'><img src="https://tc-cdn.flowus.cn/oss/5344097e-2e10-4340-9f75-d07002258fff/5.png?time=1761411600&token=bcaa3d3d52d4f49949ba1e412621d6414bdfecb1bcd2f206fea4c124241feb33&role=free"></p>
<h3 id="串口的数据帧"><a href="#串口的数据帧" class="headerlink" title="串口的数据帧"></a>串口的数据帧</h3><p class='item-img' data-src='https://tc-cdn.flowus.cn/oss/99beb243-50ab-4d2d-85fd-68972a47b6ac/6.png?time=1761411600&token=046ccd8df75d2da59d13d169470553794add049d60c5ce881c6968d240a65257&role=free'><img src="https://tc-cdn.flowus.cn/oss/99beb243-50ab-4d2d-85fd-68972a47b6ac/6.png?time=1761411600&token=046ccd8df75d2da59d13d169470553794add049d60c5ce881c6968d240a65257&role=free"></p>
<p><em>奇校验</em> ：1的总数为奇数。<br><em>偶校验</em> ：1的总数为偶数。</p>
<p><strong>波特率</strong> ：每秒传输位的数量<br>波特率越高，传输速率越快，但收发双方应当遵循相同的波特率，常用的为9600,115200</p>
<h3 id="两种不同的串口"><a href="#两种不同的串口" class="headerlink" title="两种不同的串口"></a>两种不同的串口</h3><p class='item-img' data-src='https://tc-cdn.flowus.cn/oss/e3739da3-08fa-4088-9704-de5241ce2029/7.png?time=1761411600&token=97ce09c5c94ba158d4ad3245b6fd924d07e7e3870a5210a4098d428fd22d2642&role=free'><img src="https://tc-cdn.flowus.cn/oss/e3739da3-08fa-4088-9704-de5241ce2029/7.png?time=1761411600&token=97ce09c5c94ba158d4ad3245b6fd924d07e7e3870a5210a4098d428fd22d2642&role=free"></p>
<h3 id="UART-USART-工作模式"><a href="#UART-USART-工作模式" class="headerlink" title="UART/USART 工作模式"></a>UART/USART 工作模式</h3><p class='item-img' data-src='https://tc-cdn.flowus.cn/oss/f6f674c9-62ca-46bc-a3f7-242db9424a85/8.png?time=1761411600&token=ded9cb0b7c37f64223843b71e03a6714a4a757661b7ce74bda479b066c68b406&role=free'><img src="https://tc-cdn.flowus.cn/oss/f6f674c9-62ca-46bc-a3f7-242db9424a85/8.png?time=1761411600&token=ded9cb0b7c37f64223843b71e03a6714a4a757661b7ce74bda479b066c68b406&role=free"></p>
<h1 id="I2C篇"><a href="#I2C篇" class="headerlink" title="I2C篇"></a>I2C篇</h1><h2 id="I2C总线基础知识"><a href="#I2C总线基础知识" class="headerlink" title="I2C总线基础知识"></a>I2C总线基础知识</h2><p class='item-img' data-src='https://tc-cdn.flowus.cn/oss/18470e9d-d000-4bf9-bcf5-a00e257c5ec5/9.png?time=1761411600&token=596f803b5099ce19ff2d30c499f1eed1e57decd0414841077e45b72d07ce72bd&role=free'><img src="https://tc-cdn.flowus.cn/oss/18470e9d-d000-4bf9-bcf5-a00e257c5ec5/9.png?time=1761411600&token=596f803b5099ce19ff2d30c499f1eed1e57decd0414841077e45b72d07ce72bd&role=free"></p>
<ul>
<li>I2C接上拉电阻是为了实现逻辑线与<br class='item-img' data-src='https://tc-cdn.flowus.cn/oss/cc2c017f-8a55-496a-b5c1-04b8a98321f1/10.png?time=1761411600&token=661f538ca89c25dc0adc8519da00131eebd3100a470e7bd3f71216dbd45d2607&role=free'><img src="https://tc-cdn.flowus.cn/oss/cc2c017f-8a55-496a-b5c1-04b8a98321f1/10.png?time=1761411600&token=661f538ca89c25dc0adc8519da00131eebd3100a470e7bd3f71216dbd45d2607&role=free"></li>
</ul>
<h2 id="I2C实现过程"><a href="#I2C实现过程" class="headerlink" title="I2C实现过程"></a>I2C实现过程</h2><h3 id="起始位"><a href="#起始位" class="headerlink" title="起始位"></a>起始位</h3><p class='item-img' data-src='https://tc-cdn.flowus.cn/oss/a1385253-79c4-455d-a93f-392f853f6f30/11.png?time=1761411600&token=544f91e7449e00b4b47b4d62050c2c95e47f1732544be840b6806d8fae1612a9&role=free'><img src="https://tc-cdn.flowus.cn/oss/a1385253-79c4-455d-a93f-392f853f6f30/11.png?time=1761411600&token=544f91e7449e00b4b47b4d62050c2c95e47f1732544be840b6806d8fae1612a9&role=free"></p>
<h3 id="寻址"><a href="#寻址" class="headerlink" title="寻址"></a>寻址</h3><p class='item-img' data-src='https://tc-cdn.flowus.cn/oss/ce3d5c08-cb51-4516-8316-92ca8222f2f5/12.png?time=1761411600&token=bf030d6577dc1d2e70a9f064523e22882fe72634f941252981f014343d753522&role=free'><img src="https://tc-cdn.flowus.cn/oss/ce3d5c08-cb51-4516-8316-92ca8222f2f5/12.png?time=1761411600&token=bf030d6577dc1d2e70a9f064523e22882fe72634f941252981f014343d753522&role=free"></p>
<p>出现NAK代表寻址失败，一般有几种原因</p>
<ul>
<li>地址错误</li>
<li>从机正忙</li>
<li>从机故障</li>
</ul>
<h3 id="数据传输"><a href="#数据传输" class="headerlink" title="数据传输"></a>数据传输</h3><p class='item-img' data-src='https://tc-cdn.flowus.cn/oss/cb80824a-97c2-47ad-8a23-4797e285ed8d/13.png?time=1761411600&token=c0d7f39d7a45b96fb630af4b9fa40cda4e87ba143c6dd4b1b0c05eb25fd437a5&role=free'><img src="https://tc-cdn.flowus.cn/oss/cb80824a-97c2-47ad-8a23-4797e285ed8d/13.png?time=1761411600&token=c0d7f39d7a45b96fb630af4b9fa40cda4e87ba143c6dd4b1b0c05eb25fd437a5&role=free"></p>
<h3 id="停止位"><a href="#停止位" class="headerlink" title="停止位"></a>停止位</h3><p class='item-img' data-src='https://tc-cdn.flowus.cn/oss/9e296b32-f30a-42b3-bcca-3344f9c238a7/14.png?time=1761410700&token=d0d906daa2d88868bc3dcf28796db59f5cb28b4bafddc1f03d66846884eddbaf&role=free'><img src="https://tc-cdn.flowus.cn/oss/9e296b32-f30a-42b3-bcca-3344f9c238a7/14.png?time=1761410700&token=d0d906daa2d88868bc3dcf28796db59f5cb28b4bafddc1f03d66846884eddbaf&role=free"></p>
<h2 id="I2C通讯速率"><a href="#I2C通讯速率" class="headerlink" title="I2C通讯速率"></a>I2C通讯速率</h2><p class='item-img' data-src='https://tc-cdn.flowus.cn/oss/fef68fd9-e635-4553-a107-4ae7c0d44dd6/15.png?time=1761410700&token=cca73da0a5e50862c8fd6bae1d27c050dee9361873f9e0bc6e69d658a50abab5&role=free'><img src="https://tc-cdn.flowus.cn/oss/fef68fd9-e635-4553-a107-4ae7c0d44dd6/15.png?time=1761410700&token=cca73da0a5e50862c8fd6bae1d27c050dee9361873f9e0bc6e69d658a50abab5&role=free"></p>
<p>在快速模式下可以设置时钟信号的占空比，一般有TL/TH=2/1（常用）和16/9</p>
<h1 id="时钟系统篇"><a href="#时钟系统篇" class="headerlink" title="时钟系统篇"></a>时钟系统篇</h1><p>一台电脑和单片机类比<br class='item-img' data-src='https://tc-cdn.flowus.cn/oss/b2caf2c2-c37f-4bdb-aff3-cf66e2cd9e48/16.png?time=1761411600&token=e0060744e4e2fd7204d7498d9fd5aa62f7810e52c6fc34be79b7dd82abe23b5d&role=free'><img src="https://tc-cdn.flowus.cn/oss/b2caf2c2-c37f-4bdb-aff3-cf66e2cd9e48/16.png?time=1761411600&token=e0060744e4e2fd7204d7498d9fd5aa62f7810e52c6fc34be79b7dd82abe23b5d&role=free"></p>
<p>电路分为组合逻辑电路和时序逻辑电路<br><strong>组合逻辑电路</strong> ：不含记忆元件<br><strong>时序逻辑电路</strong> ：含有记忆元件 <em>有时钟信号才能工作</em></p>
<p>单片机外设全是时序逻辑电路<br>因此单片机需要给每一个模块提供时钟信号</p>
<h2 id="时钟树"><a href="#时钟树" class="headerlink" title="时钟树"></a>时钟树</h2><p>以stm32f103c8t6为例<br class='item-img' data-src='https://tc-cdn.flowus.cn/oss/d44f4628-8ac7-4dc6-80e0-9fadb53fe81d/17.png?time=1761410700&token=980c9278558f220a41d642b82ff5369e7fd51240b2d76aa68f79513ded01e73a&role=free'><img src="https://tc-cdn.flowus.cn/oss/d44f4628-8ac7-4dc6-80e0-9fadb53fe81d/17.png?time=1761410700&token=980c9278558f220a41d642b82ff5369e7fd51240b2d76aa68f79513ded01e73a&role=free"></p>
<ul>
<li><strong>内部时钟与外部时钟</strong><br class='item-img' data-src='https://tc-cdn.flowus.cn/oss/98eed374-5e0b-473f-9d6a-2d6f969c94a1/18.png?time=1761411600&token=3ce4a68edb4b1e5fd6a9523c8565c536af6162bb4809c4a292ade37c976e88a3&role=free'><img src="https://tc-cdn.flowus.cn/oss/98eed374-5e0b-473f-9d6a-2d6f969c94a1/18.png?time=1761411600&token=3ce4a68edb4b1e5fd6a9523c8565c536af6162bb4809c4a292ade37c976e88a3&role=free"></li>
</ul>
<p>除此之外，还有<strong>锁相环</strong>（PLL），其本质为<em>倍频器</em></p>
<ul>
<li><strong>时钟源与外设</strong><br class='item-img' data-src='https://tc-cdn.flowus.cn/oss/c6428f6c-2e73-4bdf-badf-c5203fc728c4/19.png?time=1761411600&token=317ad7af46dd1cee44020753f76666e17bd6ca7ceaa60cd3fd702a597136f569&role=free'><img src="https://tc-cdn.flowus.cn/oss/c6428f6c-2e73-4bdf-badf-c5203fc728c4/19.png?time=1761411600&token=317ad7af46dd1cee44020753f76666e17bd6ca7ceaa60cd3fd702a597136f569&role=free"></li>
</ul>
<h2 id="CubeMX时钟配置"><a href="#CubeMX时钟配置" class="headerlink" title="CubeMX时钟配置"></a>CubeMX时钟配置</h2><p class='item-img' data-src='https://tc-cdn.flowus.cn/oss/f507c230-c610-497b-bd25-cbd7bffa3059/20.png?time=1761411600&token=312e28f29938066e2a99896fb45d1e3b1b1ba89175237cba965e6f1a68c66dd1&role=free'><img src="https://tc-cdn.flowus.cn/oss/f507c230-c610-497b-bd25-cbd7bffa3059/20.png?time=1761411600&token=312e28f29938066e2a99896fb45d1e3b1b1ba89175237cba965e6f1a68c66dd1&role=free"></p>
<h1 id="SPI篇"><a href="#SPI篇" class="headerlink" title="SPI篇"></a>SPI篇</h1><h2 id="SPI基础知识"><a href="#SPI基础知识" class="headerlink" title="SPI基础知识"></a>SPI基础知识</h2><p><strong>SPI总线</strong> ：Serial Peripheral Interface,串行外设接口<br>适用于高速，双向数据传输场景</p>
<ul>
<li>SPI引脚<br><strong>MOSI</strong> ：主机发送从机接收<br><strong>MISO</strong> ：主机接收从机发送<br><strong>SCK</strong>  ：串行时钟线<br><strong>NSS</strong> ：低电平有效从机选择</li>
</ul>
<h2 id="SPI的重要参数"><a href="#SPI的重要参数" class="headerlink" title="SPI的重要参数"></a>SPI的重要参数</h2><ul>
<li><p>波特率 ：<br>波特率选取原则<br>选择从机允许的最大值，考虑设备和电路承受的极限</p>
</li>
<li><p>比特位传输顺序<br>MSB ：高位有效<br>LSB ：低位有效</p>
</li>
<li><p>数据位长度<br>8-bit<br>16-bit</p>
</li>
<li><p>时钟极性 CPOL(Clock Polarity)<br class='item-img' data-src='https://tc-cdn.flowus.cn/oss/2a6a7f5d-c4ee-4dde-859e-112f882be38b/21.png?time=1761410700&token=d532e36811417002e048cbc19b601da6f54c4dba353d00648982e1b17c71c076&role=free'><img src="https://tc-cdn.flowus.cn/oss/2a6a7f5d-c4ee-4dde-859e-112f882be38b/21.png?time=1761410700&token=d532e36811417002e048cbc19b601da6f54c4dba353d00648982e1b17c71c076&role=free"></p>
</li>
<li><p>时钟相位 CPHA(Clock Phase)<br class='item-img' data-src='https://tc-cdn.flowus.cn/oss/3a516865-f3c0-43cb-aebd-a1a49a9ed505/22.png?time=1761411600&token=7d6ef2c43e0dbee05ea85def2f08fb2d9d74dbf3c52c81f847fc57e77e26cf89&role=free'><img src="https://tc-cdn.flowus.cn/oss/3a516865-f3c0-43cb-aebd-a1a49a9ed505/22.png?time=1761411600&token=7d6ef2c43e0dbee05ea85def2f08fb2d9d74dbf3c52c81f847fc57e77e26cf89&role=free"></p>
</li>
</ul>
<p>由此得到SPI的四种时钟模式<br class='item-img' data-src='https://tc-cdn.flowus.cn/oss/58e5e27e-91b4-4827-a1b6-33fd5366fd02/23.png?time=1761411600&token=79c9d33fb08fb515fa304c953d26611660176721530c9ee2bdaa24a01bde947f&role=free'><img src="https://tc-cdn.flowus.cn/oss/58e5e27e-91b4-4827-a1b6-33fd5366fd02/23.png?time=1761411600&token=79c9d33fb08fb515fa304c953d26611660176721530c9ee2bdaa24a01bde947f&role=free"></p>
<p>选取原则：<br>始终优先遵循从设备(如传感器、存储器等)数据手册中指定的SPI模式要求<br>常见选择如下</p>
<ul>
<li>Flash存储器(如W25Q系列)：通常模式0或模式3</li>
<li>SD卡(SPI模式)：模式0</li>
<li>ADXL345加速度计：模式3</li>
<li>nRF24L01无线模块：模式0</li>
</ul>
<h1 id="中断篇"><a href="#中断篇" class="headerlink" title="中断篇"></a>中断篇</h1><h2 id="中断优先级"><a href="#中断优先级" class="headerlink" title="中断优先级"></a>中断优先级</h2><h2 id="中断嵌套"><a href="#中断嵌套" class="headerlink" title="中断嵌套"></a>中断嵌套</h2><h2 id="NVIC中断仲裁器"><a href="#NVIC中断仲裁器" class="headerlink" title="NVIC中断仲裁器"></a>NVIC中断仲裁器</h2><h1 id="定时器篇"><a href="#定时器篇" class="headerlink" title="定时器篇"></a>定时器篇</h1><p>定时器内部框图<br class='item-img' data-src='https://tc-cdn.flowus.cn/oss/5ee8dab2-825b-4363-ac69-77c56aad582d/24.png?time=1761410700&token=6c33a9347e06e44d3553b1f012105a5a729be349dd6c7e51facccc667db8d318&role=free'><img src="https://tc-cdn.flowus.cn/oss/5ee8dab2-825b-4363-ac69-77c56aad582d/24.png?time=1761410700&token=6c33a9347e06e44d3553b1f012105a5a729be349dd6c7e51facccc667db8d318&role=free"></p>
<p>大致分为4部分<br class='item-img' data-src='https://tc-cdn.flowus.cn/oss/22f2ae12-3e6a-460f-83a8-7d42da1e3a39/25.png?time=1761411600&token=b9051be91eca7771737bd5bf0d8fbefb133bcc04be1a929d90bffcc9837a9d98&role=free'><img src="https://tc-cdn.flowus.cn/oss/22f2ae12-3e6a-460f-83a8-7d42da1e3a39/25.png?time=1761411600&token=b9051be91eca7771737bd5bf0d8fbefb133bcc04be1a929d90bffcc9837a9d98&role=free"></p>
<h2 id="时基单元"><a href="#时基单元" class="headerlink" title="时基单元"></a>时基单元</h2><h2 id="从模式控制器"><a href="#从模式控制器" class="headerlink" title="从模式控制器"></a>从模式控制器</h2><h2 id="输入捕获"><a href="#输入捕获" class="headerlink" title="输入捕获"></a>输入捕获</h2><h2 id="输出比较"><a href="#输出比较" class="headerlink" title="输出比较"></a>输出比较</h2><div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2025/02/24/%E5%B5%8C%E5%85%A5%E5%BC%8F/%E6%9E%B6%E6%9E%84/ProgrammingModeofMCU/">← 下一篇 一篇关于单片机程序设计模式的思考</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2024/11/15/%E5%85%B6%E4%BB%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/markdown/">Markdown 超级无敌详细教程，草履虫都能学会 上一篇 →</a></div></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="回到顶部" style="opacity: 0; display: none;">∧ </a><a class="i-index" id="to-index" href="#toc-div" title="文章目录">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="切换主题"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="/img/faction/guang.png" alt="Logo" style="margin:1em;;border-radius:30px;;"></a><h1 id="Dr"><a href="0">cherno</a></h1><div id="description"><p></p></div><div id="social-links"><a class="social img" target="_blank" rel="noopener" href="https://edu.gitee.com/CCUT_1024/dashboard"><img alt="Gitee" src="/img/gitee-fill-round.png"></a><a class="social" target="_blank" rel="noopener" href="https://bilibili.com"><i class="fa-brands fa-bilibili" alt="BiliBili"></i></a></div></div><div id="aside-block"><div id="toc-div"><h1>目录</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A5stm32f103c8t6%E4%B8%BA%E4%BE%8B%EF%BC%8C%E5%9F%BA%E4%BA%8E"><span class="toc-number">1.</span> <span class="toc-text">以stm32f103c8t6为例，基于</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GPIO%E7%AF%87"><span class="toc-number"></span> <span class="toc-text">GPIO篇</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A4%E8%AF%86%E5%BC%95%E8%84%9A"><span class="toc-number">1.</span> <span class="toc-text">认识引脚</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IO%E5%A4%8D%E7%94%A8%E4%B8%8E%E9%87%8D%E6%98%A0%E5%B0%84"><span class="toc-number">2.</span> <span class="toc-text">IO复用与重映射</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GPIO"><span class="toc-number">3.</span> <span class="toc-text">GPIO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GPIO%E7%9A%848%E7%A7%8D%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.1.</span> <span class="toc-text">GPIO的8种工作模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GPIO%E7%9A%84%E8%BE%93%E5%87%BA%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.2.</span> <span class="toc-text">GPIO的输出模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#GPIO%E7%9A%84%E8%BE%93%E5%87%BA%E9%80%9F%E5%BA%A6"><span class="toc-number">3.2.0.1.</span> <span class="toc-text">GPIO的输出速度</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GPIO%E7%9A%84%E8%BE%93%E5%85%A5%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.3.</span> <span class="toc-text">GPIO的输入模式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#UART%E7%AF%87"><span class="toc-number"></span> <span class="toc-text">UART篇</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#UART%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">1.</span> <span class="toc-text">UART基础知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Tx%E4%B8%8ERx"><span class="toc-number">1.1.</span> <span class="toc-text">Tx与Rx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%B2%E5%8F%A3%E7%9A%84%E6%95%B0%E6%8D%AE%E5%B8%A7"><span class="toc-number">1.2.</span> <span class="toc-text">串口的数据帧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E7%A7%8D%E4%B8%8D%E5%90%8C%E7%9A%84%E4%B8%B2%E5%8F%A3"><span class="toc-number">1.3.</span> <span class="toc-text">两种不同的串口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UART-USART-%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.4.</span> <span class="toc-text">UART&#x2F;USART 工作模式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#I2C%E7%AF%87"><span class="toc-number"></span> <span class="toc-text">I2C篇</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#I2C%E6%80%BB%E7%BA%BF%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">1.</span> <span class="toc-text">I2C总线基础知识</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#I2C%E5%AE%9E%E7%8E%B0%E8%BF%87%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">I2C实现过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B5%B7%E5%A7%8B%E4%BD%8D"><span class="toc-number">2.1.</span> <span class="toc-text">起始位</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BB%E5%9D%80"><span class="toc-number">2.2.</span> <span class="toc-text">寻址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93"><span class="toc-number">2.3.</span> <span class="toc-text">数据传输</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%81%9C%E6%AD%A2%E4%BD%8D"><span class="toc-number">2.4.</span> <span class="toc-text">停止位</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#I2C%E9%80%9A%E8%AE%AF%E9%80%9F%E7%8E%87"><span class="toc-number">3.</span> <span class="toc-text">I2C通讯速率</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%97%B6%E9%92%9F%E7%B3%BB%E7%BB%9F%E7%AF%87"><span class="toc-number"></span> <span class="toc-text">时钟系统篇</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%92%9F%E6%A0%91"><span class="toc-number">1.</span> <span class="toc-text">时钟树</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CubeMX%E6%97%B6%E9%92%9F%E9%85%8D%E7%BD%AE"><span class="toc-number">2.</span> <span class="toc-text">CubeMX时钟配置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SPI%E7%AF%87"><span class="toc-number"></span> <span class="toc-text">SPI篇</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SPI%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">1.</span> <span class="toc-text">SPI基础知识</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SPI%E7%9A%84%E9%87%8D%E8%A6%81%E5%8F%82%E6%95%B0"><span class="toc-number">2.</span> <span class="toc-text">SPI的重要参数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%AD%E6%96%AD%E7%AF%87"><span class="toc-number"></span> <span class="toc-text">中断篇</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E6%96%AD%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-number">1.</span> <span class="toc-text">中断优先级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E6%96%AD%E5%B5%8C%E5%A5%97"><span class="toc-number">2.</span> <span class="toc-text">中断嵌套</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NVIC%E4%B8%AD%E6%96%AD%E4%BB%B2%E8%A3%81%E5%99%A8"><span class="toc-number">3.</span> <span class="toc-text">NVIC中断仲裁器</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9A%E6%97%B6%E5%99%A8%E7%AF%87"><span class="toc-number"></span> <span class="toc-text">定时器篇</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E5%9F%BA%E5%8D%95%E5%85%83"><span class="toc-number">1.</span> <span class="toc-text">时基单元</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8E%E6%A8%A1%E5%BC%8F%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="toc-number">2.</span> <span class="toc-text">从模式控制器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E6%8D%95%E8%8E%B7"><span class="toc-number">3.</span> <span class="toc-text">输入捕获</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E6%AF%94%E8%BE%83"><span class="toc-number">4.</span> <span class="toc-text">输出比较</span></a></li></ol></div></div></aside></main><canvas id="canvas-dust"></canvas></body></html>